<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChemLab Quest â€“ Acidâ€“Base Adventure</title>
    <style>
      /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      :root {
        --bg-dark: #0d0e1a;
        --bg-card: #161830;
        --bg-panel: #1e2140;
        --accent1: #7c3aed; /* purple */
        --accent2: #06b6d4; /* cyan */
        --accent3: #10b981; /* green */
        --danger: #ef4444;
        --warn: #f59e0b;
        --text: #e2e8f0;
        --text-dim: #94a3b8;
        --radius: 14px;
        --shadow: 0 8px 32px rgba(0, 0, 0, 0.45);
      }

      body {
        font-family: "Segoe UI", system-ui, sans-serif;
        background: var(--bg-dark);
        color: var(--text);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        overflow-x: hidden;
        padding: 12px;
      }

      /* animated star-field */
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        z-index: 0;
        background:
          radial-gradient(
            ellipse 80% 60% at 20% 15%,
            rgba(124, 58, 237, 0.18) 0%,
            transparent 60%
          ),
          radial-gradient(
            ellipse 60% 50% at 80% 80%,
            rgba(6, 182, 212, 0.14) 0%,
            transparent 55%
          ),
          radial-gradient(
            ellipse 50% 40% at 50% 50%,
            rgba(16, 185, 129, 0.08) 0%,
            transparent 60%
          );
        pointer-events: none;
      }

      /* â”€â”€ Wrapper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #app {
        position: relative;
        z-index: 1;
        width: 100%;
        max-width: 680px;
      }

      /* â”€â”€ Screens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .screen {
        display: none;
        animation: fadeIn 0.4s ease;
      }
      .screen.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(16px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* â”€â”€ Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .card {
        background: var(--bg-card);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: var(--radius);
        padding: 28px 24px;
        box-shadow: var(--shadow);
      }

      /* â”€â”€ Start Screen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #startScreen {
        text-align: center;
      }
      .logo-icon {
        font-size: 72px;
        line-height: 1;
        margin-bottom: 10px;
        filter: drop-shadow(0 0 18px rgba(124, 58, 237, 0.7));
      }
      .game-title {
        font-size: clamp(1.8rem, 6vw, 2.8rem);
        font-weight: 800;
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 6px;
      }
      .game-subtitle {
        color: var(--text-dim);
        font-size: clamp(0.85rem, 2.5vw, 1rem);
        margin-bottom: 28px;
      }
      .mission-badges {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin-bottom: 30px;
      }
      .badge {
        background: var(--bg-panel);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 50px;
        padding: 7px 16px;
        font-size: 0.8rem;
        color: var(--accent2);
        display: flex;
        align-items: center;
        gap: 6px;
      }

      /* â”€â”€ Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        min-height: 52px;
        padding: 0 28px;
        border-radius: 50px;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 700;
        transition:
          transform 0.15s,
          box-shadow 0.15s,
          filter 0.15s;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
      }
      .btn:active {
        transform: scale(0.95);
      }
      .btn-primary {
        background: linear-gradient(135deg, var(--accent1), #5b21b6);
        color: #fff;
        box-shadow: 0 4px 20px rgba(124, 58, 237, 0.5);
        width: 100%;
        font-size: 1.05rem;
      }
      .btn-primary:hover {
        filter: brightness(1.12);
      }
      .btn-secondary {
        background: var(--bg-panel);
        color: var(--accent2);
        border: 1px solid rgba(6, 182, 212, 0.4);
        width: 100%;
      }
      .btn-secondary:hover {
        background: rgba(6, 182, 212, 0.1);
      }

      /* Answer option buttons */
      .option-btn {
        display: block;
        width: 100%;
        min-height: 54px;
        padding: 12px 18px;
        margin-bottom: 12px;
        border-radius: var(--radius);
        border: 2px solid rgba(255, 255, 255, 0.1);
        background: var(--bg-panel);
        color: var(--text);
        font-size: clamp(0.9rem, 2.5vw, 1rem);
        font-weight: 600;
        text-align: left;
        cursor: pointer;
        transition:
          border-color 0.2s,
          background 0.2s,
          transform 0.15s;
        -webkit-tap-highlight-color: transparent;
        line-height: 1.4;
      }
      .option-btn:hover {
        border-color: var(--accent2);
        background: rgba(6, 182, 212, 0.08);
      }
      .option-btn:active {
        transform: scale(0.97);
      }
      .option-btn.correct {
        border-color: var(--accent3);
        background: rgba(16, 185, 129, 0.15);
        animation: pulse-green 0.4s ease;
      }
      .option-btn.wrong {
        border-color: var(--danger);
        background: rgba(239, 68, 68, 0.12);
        animation: shake 0.35s ease;
      }
      .option-btn:disabled {
        cursor: default;
      }
      .option-btn .opt-letter {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.08);
        font-size: 0.8rem;
        margin-right: 10px;
        flex-shrink: 0;
        vertical-align: middle;
      }

      @keyframes pulse-green {
        0% {
          box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.6);
        }
        100% {
          box-shadow: 0 0 0 14px rgba(16, 185, 129, 0);
        }
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-6px);
        }
        75% {
          transform: translateX(6px);
        }
      }

      /* â”€â”€ HUD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .hud {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--bg-panel);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: var(--radius);
        padding: 10px 18px;
        margin-bottom: 16px;
        flex-wrap: wrap;
        gap: 8px;
      }
      .hud-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        font-weight: 700;
      }
      .hud-label {
        color: var(--text-dim);
        font-weight: 400;
        font-size: 0.78rem;
      }
      .hearts {
        font-size: 1.1rem;
        letter-spacing: 2px;
      }
      .score-val {
        color: var(--accent2);
        font-size: 1.1rem;
      }
      .level-pip {
        display: flex;
        gap: 5px;
      }
      .pip {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.15);
        transition: background 0.3s;
      }
      .pip.done {
        background: var(--accent3);
      }
      .pip.active {
        background: var(--accent1);
      }

      /* â”€â”€ Question card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #gameScreen .card {
        padding: 22px 20px;
      }

      .level-label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        color: #fff;
        font-size: 0.75rem;
        font-weight: 700;
        padding: 4px 14px;
        border-radius: 50px;
        margin-bottom: 14px;
        text-transform: uppercase;
        letter-spacing: 0.06em;
      }
      .question-text {
        font-size: clamp(1rem, 3vw, 1.18rem);
        font-weight: 700;
        line-height: 1.55;
        margin-bottom: 20px;
        color: var(--text);
      }
      .question-highlight {
        display: inline-block;
        background: rgba(124, 58, 237, 0.2);
        border: 1px solid rgba(124, 58, 237, 0.4);
        border-radius: 8px;
        padding: 2px 10px;
        font-family: "Courier New", monospace;
        font-size: 1.05em;
        color: #c4b5fd;
      }

      /* substance table for level 1 */
      .substance-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }
      .substance-chip {
        background: var(--bg-panel);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 10px;
        padding: 10px 16px;
        font-family: "Courier New", monospace;
        font-size: 1rem;
        font-weight: 700;
        color: var(--accent2);
        text-align: center;
        min-width: 90px;
        position: relative;
      }
      .substance-chip .chip-label {
        font-family: "Segoe UI", sans-serif;
        font-size: 0.7rem;
        color: var(--text-dim);
        font-weight: 400;
        margin-top: 4px;
        display: block;
      }

      /* pH scale visual */
      .ph-scale {
        height: 18px;
        border-radius: 50px;
        background: linear-gradient(
          to right,
          #ef4444,
          #f97316,
          #facc15,
          #4ade80,
          #06b6d4,
          #6366f1,
          #7c3aed
        );
        position: relative;
        margin-bottom: 10px;
      }
      .ph-marker {
        position: absolute;
        top: -4px;
        transform: translateX(-50%);
        width: 26px;
        height: 26px;
        border-radius: 50%;
        border: 3px solid #fff;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        background: #fff;
        transition: left 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      }
      .ph-labels {
        display: flex;
        justify-content: space-between;
        font-size: 0.7rem;
        color: var(--text-dim);
        margin-bottom: 16px;
      }

      /* â”€â”€ Feedback toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #feedback {
        text-align: center;
        font-size: 1rem;
        font-weight: 700;
        min-height: 28px;
        margin: 10px 0 4px;
        transition: opacity 0.3s;
      }
      #feedback.correct {
        color: var(--accent3);
      }
      #feedback.wrong {
        color: var(--danger);
      }

      /* â”€â”€ Progress bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .progress-wrap {
        background: rgba(255, 255, 255, 0.06);
        border-radius: 50px;
        height: 6px;
        margin-bottom: 16px;
        overflow: hidden;
      }
      .progress-bar {
        height: 100%;
        border-radius: 50px;
        background: linear-gradient(90deg, var(--accent1), var(--accent2));
        transition: width 0.5s ease;
      }

      /* â”€â”€ Victory / Game Over â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #victoryScreen,
      #gameOverScreen {
        text-align: center;
      }

      .end-icon {
        font-size: 80px;
        margin-bottom: 12px;
        display: block;
        animation: bounce 1s infinite alternate;
      }
      @keyframes bounce {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-12px);
        }
      }

      .end-title {
        font-size: clamp(1.6rem, 5vw, 2.4rem);
        font-weight: 800;
        margin-bottom: 8px;
      }
      .end-score {
        font-size: 3rem;
        font-weight: 900;
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 10px 0 4px;
      }
      .end-msg {
        color: var(--text-dim);
        margin-bottom: 24px;
        font-size: 0.95rem;
      }

      .stats-row {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        margin-bottom: 28px;
      }
      .stat-box {
        background: var(--bg-panel);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 14px 22px;
        min-width: 110px;
      }
      .stat-box .sv {
        font-size: 1.6rem;
        font-weight: 800;
        color: var(--accent2);
      }
      .stat-box .sl {
        font-size: 0.75rem;
        color: var(--text-dim);
        margin-top: 2px;
      }

      /* â”€â”€ How-to-play modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .modal-overlay {
        position: fixed;
        inset: 0;
        z-index: 100;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
        animation: fadeIn 0.25s ease;
      }
      .modal-overlay.hidden {
        display: none;
      }
      .modal-box {
        background: var(--bg-card);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: var(--radius);
        padding: 28px 24px;
        max-width: 460px;
        width: 100%;
        box-shadow: var(--shadow);
        max-height: 90vh;
        overflow-y: auto;
      }
      .modal-title {
        font-size: 1.3rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 16px;
      }
      .how-step {
        display: flex;
        gap: 12px;
        margin-bottom: 14px;
        align-items: flex-start;
      }
      .how-num {
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        color: #fff;
        font-weight: 800;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.85rem;
        flex-shrink: 0;
      }
      .how-text {
        font-size: 0.9rem;
        line-height: 1.5;
        color: var(--text-dim);
      }
      .how-text strong {
        color: var(--text);
      }

      /* â”€â”€ Notification snack â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #snack {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--bg-panel);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 50px;
        padding: 10px 22px;
        font-size: 0.9rem;
        font-weight: 600;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        z-index: 200;
        opacity: 0;
        transition: opacity 0.3s;
        pointer-events: none;
        white-space: nowrap;
      }
      #snack.show {
        opacity: 1;
      }

      /* â”€â”€ Level transition overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #levelTransition {
        position: fixed;
        inset: 0;
        z-index: 150;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: rgba(13, 14, 26, 0.95);
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.4s;
      }
      #levelTransition.show {
        opacity: 1;
        pointer-events: all;
      }
      .lt-badge {
        font-size: 3rem;
        margin-bottom: 8px;
      }
      .lt-title {
        font-size: 1.8rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--accent1), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-align: center;
        padding: 0 20px;
      }
      .lt-sub {
        color: var(--text-dim);
        margin-top: 8px;
        font-size: 0.95rem;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• START SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="startScreen" class="screen active">
        <div class="card" style="text-align: center">
          <div class="logo-icon">âš—ï¸</div>
          <h1 class="game-title">ChemLab Quest</h1>
          <p class="game-subtitle">Acidâ€“Base Adventure Â· Grade 11 Chemistry</p>

          <div class="mission-badges">
            <span class="badge">ğŸ§« Mission 1: Classification</span>
            <span class="badge">ğŸ”¬ Mission 2: pH Scale</span>
            <span class="badge">âš¡ Mission 3: Ionization</span>
            <span class="badge">ğŸ§ª Mission 4: Neutralization</span>
            <span class="badge">ğŸ§® Mission 5: pH Calculation</span>
          </div>

          <button class="btn btn-primary" onclick="startGame()" id="startBtn">
            ğŸš€ Start Mission
          </button>
          <br /><br />
          <button class="btn btn-secondary" onclick="showModal()">
            ğŸ“– How to Play
          </button>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="gameScreen" class="screen">
        <!-- HUD -->
        <div class="hud">
          <div class="hud-item">
            <span class="hud-label">SCORE</span>
            <span class="score-val" id="scoreDisplay">0</span>
          </div>
          <div
            class="hud-item"
            style="flex-direction: column; align-items: center; gap: 4px"
          >
            <div class="level-pip" id="levelPips"></div>
            <span class="hud-label" id="levelLabel">Level 1</span>
          </div>
          <div class="hud-item">
            <span class="hud-label">LIVES</span>
            <span class="hearts" id="heartsDisplay">â¤ï¸â¤ï¸â¤ï¸</span>
          </div>
        </div>

        <!-- Progress -->
        <div class="progress-wrap">
          <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <!-- Question card -->
        <div class="card" id="questionCard">
          <div class="level-label" id="levelTag">âš—ï¸ Mission 1</div>
          <div class="question-text" id="questionText"></div>
          <div id="visualArea"></div>
          <div id="optionsArea"></div>
          <div id="feedback"></div>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• VICTORY SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="victoryScreen" class="screen">
        <div class="card">
          <span class="end-icon">ğŸ†</span>
          <h2 class="end-title" style="color: var(--accent3)">
            Mission Complete!
          </h2>
          <p class="end-msg">You mastered all 5 Acidâ€“Base missions!</p>
          <div class="end-score" id="victoryScore">0</div>
          <p class="end-msg">Total Score</p>
          <div class="stats-row">
            <div class="stat-box">
              <div class="sv" id="vCorrect">0</div>
              <div class="sl">âœ… Correct</div>
            </div>
            <div class="stat-box">
              <div class="sv" id="vWrong">0</div>
              <div class="sl">âŒ Wrong</div>
            </div>
            <div class="stat-box">
              <div class="sv" id="vLives">0</div>
              <div class="sl">â¤ï¸ Lives Left</div>
            </div>
          </div>
          <button class="btn btn-primary" onclick="restartGame()">
            ğŸ”„ Play Again
          </button>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME OVER SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="gameOverScreen" class="screen">
        <div class="card">
          <span class="end-icon">ğŸ’€</span>
          <h2 class="end-title" style="color: var(--danger)">Game Over!</h2>
          <p class="end-msg">
            You ran out of lives. Keep studying and try again!
          </p>
          <div class="end-score" id="gameOverScore">0</div>
          <p class="end-msg">Final Score</p>
          <div class="stats-row">
            <div class="stat-box">
              <div class="sv" id="goCorrect">0</div>
              <div class="sl">âœ… Correct</div>
            </div>
            <div class="stat-box">
              <div class="sv" id="goWrong">0</div>
              <div class="sl">âŒ Wrong</div>
            </div>
            <div class="stat-box">
              <div class="sv" id="goLevel">0</div>
              <div class="sl">ğŸ“ Level</div>
            </div>
          </div>
          <button class="btn btn-primary" onclick="restartGame()">
            ğŸ”„ Try Again
          </button>
        </div>
      </div>
    </div>
    <!-- /#app -->

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOW TO PLAY MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal-overlay hidden" id="howModal" onclick="hideModal(event)">
      <div class="modal-box" onclick="event.stopPropagation()">
        <div class="modal-title">ğŸ“– How to Play</div>
        <div class="how-step">
          <div class="how-num">1</div>
          <div class="how-text">
            <strong>Read each question</strong> carefully. You are a young
            scientist completing chemistry missions!
          </div>
        </div>
        <div class="how-step">
          <div class="how-num">2</div>
          <div class="how-text">
            <strong>Pick the correct answer</strong> from the options. Tap or
            click to submit.
          </div>
        </div>
        <div class="how-step">
          <div class="how-num">3</div>
          <div class="how-text">
            <strong>+10 points</strong> for correct answers Â·
            <strong>â€“5 points</strong> for wrong answers.
          </div>
        </div>
        <div class="how-step">
          <div class="how-num">4</div>
          <div class="how-text">
            You have <strong>3 lives â¤ï¸</strong>. Lose a life for every wrong
            answer. Game over when lives reach 0.
          </div>
        </div>
        <div class="how-step">
          <div class="how-num">5</div>
          <div class="how-text">
            <strong>5 levels</strong> await you: Classification â†’ pH â†’
            Ionization â†’ Neutralization â†’ pH Calculation.
          </div>
        </div>
        <br />
        <button class="btn btn-primary" onclick="hideModal()">
          Got it! ğŸš€
        </button>
      </div>
    </div>

    <!-- Level transition overlay -->
    <div id="levelTransition">
      <div class="lt-badge" id="ltBadge">âš—ï¸</div>
      <div class="lt-title" id="ltTitle">Level 2 Unlocked!</div>
      <div class="lt-sub" id="ltSub">pH Identification</div>
    </div>

    <!-- Snackbar -->
    <div id="snack"></div>

    <script>
      /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUESTION DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
      const LEVELS = [
        /* â”€â”€â”€ Level 1: Acidâ€“Base Classification â”€â”€â”€ */
        {
          title: "Mission 1",
          name: "Acidâ€“Base Classification",
          icon: "ğŸ§«",
          questions: [
            {
              text: "HCl is commonly known as hydrochloric acid. How would you classify HCl?",
              visual: "chip",
              chipData: [{ formula: "HCl", name: "Hydrochloric Acid" }],
              options: ["Acid", "Base", "Neutral Salt"],
              correct: 0,
              explanation:
                "HCl donates Hâº ions in water â†’ it is a strong ACID.",
            },
            {
              text: "Sodium hydroxide (NaOH) is used in soap making. What is its classification?",
              visual: "chip",
              chipData: [{ formula: "NaOH", name: "Sodium Hydroxide" }],
              options: ["Acid", "Strong Base", "Neutral"],
              correct: 1,
              explanation:
                "NaOH releases OHâ» ions in water â†’ it is a strong BASE.",
            },
            {
              text: "Ammonia (NHâ‚ƒ) has a pungent smell and is used in cleaning products. What is its nature?",
              visual: "chip",
              chipData: [{ formula: "NHâ‚ƒ", name: "Ammonia" }],
              options: ["Acid", "Weak Base", "Neutral"],
              correct: 1,
              explanation:
                "NHâ‚ƒ accepts Hâº from water forming NHâ‚„âº and OHâ» â†’ it is a weak BASE.",
            },
            {
              text: "Acetic acid (CHâ‚ƒCOOH) gives vinegar its sour taste. How is it classified?",
              visual: "chip",
              chipData: [{ formula: "CHâ‚ƒCOOH", name: "Acetic Acid" }],
              options: ["Weak Acid", "Strong Acid", "Base"],
              correct: 0,
              explanation:
                "CHâ‚ƒCOOH partially ionizes, releasing Hâº â†’ it is a weak ACID.",
            },
            {
              text: "Table salt (NaCl) dissolves in water. What is its acidâ€“base classification?",
              visual: "chip",
              chipData: [{ formula: "NaCl", name: "Sodium Chloride" }],
              options: ["Acid", "Base", "Neutral Salt"],
              correct: 2,
              explanation:
                "NaCl is the salt of a strong acid and strong base â†’ NEUTRAL (pH â‰ˆ 7).",
            },
          ],
        },

        /* â”€â”€â”€ Level 2: pH Identification â”€â”€â”€ */
        {
          title: "Mission 2",
          name: "pH Identification",
          icon: "ğŸ”¬",
          questions: [
            {
              text: "A solution has a pH of 2. What is its classification?",
              visual: "ph",
              phValue: 2,
              options: ["Strong Acid", "Base", "Neutral"],
              correct: 0,
              explanation:
                "pH 2 is far below 7 â†’ strong ACID (very low pH = high [Hâº]).",
            },
            {
              text: "Pure water at 25Â°C has a pH of exactly 7. What does this mean?",
              visual: "ph",
              phValue: 7,
              options: ["Acidic", "Neutral", "Basic"],
              correct: 1,
              explanation: "pH 7 = equal [Hâº] and [OHâ»] â†’ NEUTRAL solution.",
            },
            {
              text: "Bleach has a pH of 11. What is its classification?",
              visual: "ph",
              phValue: 11,
              options: ["Acid", "Neutral", "Base"],
              correct: 2,
              explanation:
                "pH 11 is well above 7 â†’ BASE (high pH = high [OHâ»]).",
            },
            {
              text: "Lemon juice has a pH of about 2â€“3. Orange juice has pH 3â€“4. Which is MORE acidic?",
              visual: "none",
              options: [
                "Lemon juice (pH 2)",
                "Orange juice (pH 4)",
                "They are equally acidic",
              ],
              correct: 0,
              explanation:
                "Lower pH = more acidic. Lemon juice (pH 2) is more acidic than orange juice (pH 4).",
            },
            {
              text: "A solution has [Hâº] = 10â»â¹ mol/L. What is its pH, and is it acid, base, or neutral?",
              visual: "none",
              options: ["pH 9 â†’ Basic", "pH 5 â†’ Acidic", "pH 7 â†’ Neutral"],
              correct: 0,
              explanation:
                "pH = â€“log[Hâº] = â€“log(10â»â¹) = 9. pH 9 > 7 â†’ the solution is BASIC.",
            },
          ],
        },

        /* â”€â”€â”€ Level 3: Ionization â”€â”€â”€ */
        {
          title: "Mission 3",
          name: "Ionization",
          icon: "âš¡",
          questions: [
            {
              text: "Which substance produces Hâº ions when dissolved in water?",
              visual: "none",
              options: [
                "HNOâ‚ƒ (Nitric acid)",
                "Ca(OH)â‚‚ (Calcium hydroxide)",
                "KCl (Potassium chloride)",
              ],
              correct: 0,
              explanation:
                "HNOâ‚ƒ â†’ Hâº + NOâ‚ƒâ» in water. Acids produce Hâº (proton donors).",
            },
            {
              text: "Which of the following is the correct ionization equation for HCl in water?",
              visual: "none",
              options: ["HCl â†’ Hâº + Clâ»", "HCl â†’ OHâ» + ClHâº", "HCl â†’ Hâ‚‚ + Clâ‚‚"],
              correct: 0,
              explanation:
                "HCl fully ionizes: HCl â†’ Hâº + Clâ». This shows it is a strong acid.",
            },
            {
              text: "A BrÃ¸nstedâ€“Lowry acid is defined as a substance that:",
              visual: "none",
              options: [
                "Donates a proton (Hâº) to another substance",
                "Accepts a proton (Hâº) from another substance",
                "Produces OHâ» ions in water",
              ],
              correct: 0,
              explanation:
                "BrÃ¸nstedâ€“Lowry acid = proton DONOR. Bases are proton acceptors.",
            },
            {
              text: "Ammonia (NHâ‚ƒ) reacts with water: NHâ‚ƒ + Hâ‚‚O â‡Œ NHâ‚„âº + OHâ». What role does NHâ‚ƒ play?",
              visual: "none",
              options: [
                "BrÃ¸nstedâ€“Lowry base (proton acceptor)",
                "BrÃ¸nstedâ€“Lowry acid (proton donor)",
                "Neutral spectator",
              ],
              correct: 0,
              explanation:
                "NHâ‚ƒ accepts Hâº from water to form NHâ‚„âº â†’ it acts as a BASE (proton acceptor).",
            },
            {
              text: "Which solution would conduct electricity MOST effectively due to complete ionization?",
              visual: "none",
              options: [
                "HCl (aq) â€” strong acid, fully ionized",
                "CHâ‚ƒCOOH (aq) â€” weak acid, partially ionized",
                "Sugar (aq) â€” non-electrolyte",
              ],
              correct: 0,
              explanation:
                "Strong electrolytes (like HCl) fully ionize â†’ produce more ions â†’ higher conductivity.",
            },
          ],
        },

        /* â”€â”€â”€ Level 4: Neutralization â”€â”€â”€ */
        {
          title: "Mission 4",
          name: "Neutralization",
          icon: "ğŸ§ª",
          questions: [
            {
              text: "What are the products of the reaction: HCl + NaOH â†’ ?",
              visual: "none",
              options: [
                "NaCl + Hâ‚‚O (salt + water)",
                "NaHCOâ‚ƒ + Hâ‚‚",
                "Naâº + HClOâ‚„",
              ],
              correct: 0,
              explanation:
                "Acid + Base â†’ Salt + Water. HCl + NaOH â†’ NaCl + Hâ‚‚O",
            },
            {
              text: "In the reaction Hâ‚‚SOâ‚„ + 2KOH â†’ Kâ‚‚SOâ‚„ + 2Hâ‚‚O, what type of reaction is this?",
              visual: "none",
              options: ["Neutralization", "Combustion", "Decomposition"],
              correct: 0,
              explanation:
                "Acid (Hâ‚‚SOâ‚„) reacts with base (KOH) â†’ salt + water. This is NEUTRALIZATION.",
            },
            {
              text: "A student mixes equal moles of HCl and NaOH in water. What is the approximate pH of the resulting solution?",
              visual: "none",
              options: [
                "pH â‰ˆ 7 (Neutral)",
                "pH â‰ˆ 2 (Acidic)",
                "pH â‰ˆ 12 (Basic)",
              ],
              correct: 0,
              explanation:
                "Equal moles of strong acid + strong base â†’ neutral solution, pH â‰ˆ 7.",
            },
            {
              text: "What product is formed when acetic acid (CHâ‚ƒCOOH) reacts with NaOH?",
              visual: "none",
              options: [
                "CHâ‚ƒCOONa + Hâ‚‚O (sodium acetate + water)",
                "CHâ‚„ + NaOOH",
                "NaCl + COâ‚‚",
              ],
              correct: 0,
              explanation: "CHâ‚ƒCOOH + NaOH â†’ CHâ‚ƒCOONa (sodium acetate) + Hâ‚‚O.",
            },
            {
              text: "During a titration, the equivalence point is:",
              visual: "none",
              options: [
                "The point where moles of acid = moles of base",
                "When pH first drops below 7",
                "When the indicator first turns pink",
              ],
              correct: 0,
              explanation:
                "At equivalence point: moles of Hâº = moles of OHâ». Reaction is complete.",
            },
          ],
        },

        /* â”€â”€â”€ Level 5: Simple pH Calculation â”€â”€â”€ */
        {
          title: "Mission 5",
          name: "pH Calculation",
          icon: "ğŸ§®",
          questions: [
            {
              text: "A solution of 0.01 M HCl is prepared. Since HCl is a strong acid, calculate the pH.",
              visual: "none",
              options: ["pH = 2", "pH = 7", "pH = 12"],
              correct: 0,
              explanation: "[Hâº] = 0.01 = 10â»Â² mol/L â†’ pH = â€“log(10â»Â²) = 2",
            },
            {
              text: "Calculate the pH of a 0.001 M HNOâ‚ƒ solution (strong acid, fully ionized).",
              visual: "none",
              options: ["pH = 3", "pH = 1", "pH = 11"],
              correct: 0,
              explanation: "[Hâº] = 0.001 = 10â»Â³ mol/L â†’ pH = â€“log(10â»Â³) = 3",
            },
            {
              text: "A NaOH solution has [OHâ»] = 0.1 mol/L. Calculate the pOH, then find the pH.",
              visual: "none",
              options: ["pH = 13 (pOH = 1)", "pH = 1 (pOH = 13)", "pH = 7"],
              correct: 0,
              explanation:
                "pOH = â€“log(0.1) = 1 â†’ pH = 14 â€“ pOH = 14 â€“ 1 = 13 (strong base).",
            },
            {
              text: "If [Hâº] = 10â»âµ mol/L in a solution at 25Â°C, what is the pH?",
              visual: "none",
              options: [
                "pH = 5 (Acidic)",
                "pH = 9 (Basic)",
                "pH = 7 (Neutral)",
              ],
              correct: 0,
              explanation:
                "pH = â€“log(10â»âµ) = 5. Since 5 < 7, the solution is ACIDIC.",
            },
            {
              text: "A strong base solution has pH = 11. What is the [OHâ»] concentration?",
              visual: "none",
              options: [
                "[OHâ»] = 10â»Â³ mol/L",
                "[OHâ»] = 10â»Â¹Â¹ mol/L",
                "[OHâ»] = 10â»â· mol/L",
              ],
              correct: 0,
              explanation: "pOH = 14 â€“ 11 = 3 â†’ [OHâ»] = 10â»Â³ mol/L",
            },
          ],
        },
      ];

      /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GAME STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
      let score = 0;
      let lives = 3;
      let currentLvl = 0; // 0-indexed level
      let currentQ = 0; // question index within level
      let answered = false;
      let correctCount = 0;
      let wrongCount = 0;
      let snackTimer = null;
      let transTimer = null;

      /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CORE FUNCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
      function startGame() {
        score = 0;
        lives = 3;
        currentLvl = 0;
        currentQ = 0;
        correctCount = 0;
        wrongCount = 0;
        showScreen("gameScreen");
        buildLevelPips();
        showQuestion();
      }

      function restartGame() {
        showScreen("startScreen");
      }

      function showScreen(id) {
        document
          .querySelectorAll(".screen")
          .forEach((s) => s.classList.remove("active"));
        document.getElementById(id).classList.add("active");
      }

      function buildLevelPips() {
        const container = document.getElementById("levelPips");
        container.innerHTML = "";
        LEVELS.forEach((_, i) => {
          const pip = document.createElement("div");
          pip.className = "pip";
          pip.id = "pip" + i;
          container.appendChild(pip);
        });
        updatePips();
      }

      function updatePips() {
        LEVELS.forEach((_, i) => {
          const pip = document.getElementById("pip" + i);
          if (!pip) return;
          pip.className = "pip";
          if (i < currentLvl) pip.classList.add("done");
          else if (i === currentLvl) pip.classList.add("active");
        });
      }

      function updateHUD() {
        document.getElementById("scoreDisplay").textContent = score;
        document.getElementById("levelLabel").textContent =
          "Level " + (currentLvl + 1);

        const h = [];
        for (let i = 0; i < lives; i++) h.push("â¤ï¸");
        for (let i = lives; i < 3; i++) h.push("ğŸ–¤");
        document.getElementById("heartsDisplay").textContent = h.join("");

        // progress within current level
        const total = LEVELS[currentLvl].questions.length;
        const pct = (currentQ / total) * 100;
        document.getElementById("progressBar").style.width = pct + "%";
      }

      function showQuestion() {
        answered = false;
        updateHUD();
        updatePips();

        const lvl = LEVELS[currentLvl];
        const q = lvl.questions[currentQ];

        // level tag
        document.getElementById("levelTag").textContent =
          lvl.icon + " " + lvl.title + ": " + lvl.name;

        // question text
        document.getElementById("questionText").innerHTML = q.text;

        // visual area
        const va = document.getElementById("visualArea");
        va.innerHTML = "";

        if (q.visual === "chip" && q.chipData) {
          const grid = document.createElement("div");
          grid.className = "substance-grid";
          q.chipData.forEach((c) => {
            const chip = document.createElement("div");
            chip.className = "substance-chip";
            chip.innerHTML = `${c.formula}<span class="chip-label">${c.name}</span>`;
            grid.appendChild(chip);
          });
          va.appendChild(grid);
        } else if (q.visual === "ph") {
          const pct = (q.phValue / 14) * 100;
          va.innerHTML = `
      <div class="ph-scale" style="margin-bottom:6px">
        <div class="ph-marker" id="phMarker" style="left:0%"></div>
      </div>
      <div class="ph-labels">
        <span>0 â€” Strongest Acid</span>
        <span>7 â€” Neutral</span>
        <span>14 â€” Strongest Base</span>
      </div>`;
          setTimeout(() => {
            const m = document.getElementById("phMarker");
            if (m) m.style.left = pct + "%";
          }, 60);
        }

        // options
        const oa = document.getElementById("optionsArea");
        oa.innerHTML = "";
        const letters = ["A", "B", "C", "D"];
        q.options.forEach((opt, i) => {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.innerHTML = `<span class="opt-letter">${letters[i]}</span>${opt}`;
          btn.onclick = () => checkAnswer(i);
          oa.appendChild(btn);
        });

        document.getElementById("feedback").textContent = "";
        document.getElementById("feedback").className = "";
      }

      function checkAnswer(chosen) {
        if (answered) return;
        answered = true;

        const lvl = LEVELS[currentLvl];
        const q = lvl.questions[currentQ];
        const opts = document.querySelectorAll(".option-btn");

        // disable all
        opts.forEach((b) => (b.disabled = true));

        const fb = document.getElementById("feedback");

        if (chosen === q.correct) {
          score += 10;
          correctCount++;
          opts[chosen].classList.add("correct");
          fb.textContent = "âœ… Correct! " + q.explanation;
          fb.className = "correct";
          showSnack("+10 pts ğŸ‰");
        } else {
          score = Math.max(0, score - 5);
          wrongCount++;
          lives--;
          opts[chosen].classList.add("wrong");
          opts[q.correct].classList.add("correct");
          fb.textContent = "âŒ Wrong! " + q.explanation;
          fb.className = "wrong";
          showSnack("-5 pts ğŸ’”");
        }

        updateHUD();

        if (lives <= 0) {
          setTimeout(gameOver, 1600);
          return;
        }

        // advance
        setTimeout(() => {
          currentQ++;
          if (currentQ >= lvl.questions.length) {
            // level done
            currentQ = 0;
            currentLvl++;
            if (currentLvl >= LEVELS.length) {
              victory();
            } else {
              nextLevel();
            }
          } else {
            showQuestion();
          }
        }, 1800);
      }

      function nextLevel() {
        const lvl = LEVELS[currentLvl];
        const overlay = document.getElementById("levelTransition");
        document.getElementById("ltBadge").textContent = lvl.icon;
        document.getElementById("ltTitle").textContent =
          "Level " + (currentLvl + 1) + " Unlocked!";
        document.getElementById("ltSub").textContent = lvl.name;
        overlay.classList.add("show");
        setTimeout(() => {
          overlay.classList.remove("show");
          showQuestion();
        }, 2000);
      }

      function gameOver() {
        document.getElementById("gameOverScore").textContent = score;
        document.getElementById("goCorrect").textContent = correctCount;
        document.getElementById("goWrong").textContent = wrongCount;
        document.getElementById("goLevel").textContent = currentLvl + 1;
        showScreen("gameOverScreen");
      }

      function victory() {
        document.getElementById("victoryScore").textContent = score;
        document.getElementById("vCorrect").textContent = correctCount;
        document.getElementById("vWrong").textContent = wrongCount;
        document.getElementById("vLives").textContent = lives;
        showScreen("victoryScreen");
      }

      /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UI HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
      function showSnack(msg) {
        const s = document.getElementById("snack");
        s.textContent = msg;
        s.classList.add("show");
        if (snackTimer) clearTimeout(snackTimer);
        snackTimer = setTimeout(() => s.classList.remove("show"), 1400);
      }

      function showModal() {
        document.getElementById("howModal").classList.remove("hidden");
      }
      function hideModal(e) {
        if (!e || e.target === document.getElementById("howModal")) {
          document.getElementById("howModal").classList.add("hidden");
        }
      }
    </script>
  </body>
</html>
